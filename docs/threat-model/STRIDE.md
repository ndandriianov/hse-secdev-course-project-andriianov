| Элемент DFD | Поток/Узел | Угроза (STRIDE) | Описание угрозы | Контроль (Countermeasure)                                                                                                                      | Ссылка на NFR |
| :--- | :--- | :--- | :--- |:-----------------------------------------------------------------------------------------------------------------------------------------------|:--------------|
| **F1** | E1 → P1 (HTTPS Request) | **T**ampering (Подмена) | Злоумышленник может перехватить запрос и изменить данные (например, `objective_id` или `progress`). | Использование **HTTPS** (TLS/SSL) для защиты канала; **Валидация** всех входящих данных на P3.                                                 | NFR-3         |
| **F2, F4** | P1 → P2/P3 (Internal API) | **S**poofing (Подмена) | Злоумышленник, получивший доступ к сети Edge, может выдать себя за P1 (Edge Proxy) и отправить запросы. | **Двусторонняя TLS (mTLS)** между P1, P2 и P3; **Авторизация** (ACL) для внутренних сервисов.                                                  | NFR-3         |
| **P2** | Authentication Service | **D**enial of Service (Отказ) | Атака Brute-Force на вход в систему, которая может заблокировать легитимных пользователей или исчерпать ресурсы P2. | **Механизм блокировки** учетной записи после 5 неуспешных попыток входа за 3 минуты.                                                           | **NFR-4**     |
| **P3** | OKR Logic Service | **I**nformation Disclosure (Раскрытие) | Внутренняя ошибка в P3 может привести к раскрытию чувствительной информации о других целях/пользователях через лог или ответ API. | **Авторизация (RBAC)** на уровне P3: проверка, что токен соответствует владельцу запрашиваемых данных; **Унифицированные ответы** об ошибках.  | NFR-3, NFR-6  |
| **D1** | OKR Data (Postgres) | **T**ampering (Подмена) | Неавторизованная запись или изменение данных (целей, ключевых результатов) в базе напрямую или через уязвимость в P3. | **Принцип наименьших привилегий** для P3 (только необходимые операции SQL); **Аудит** всех операций записи (F5).                               | NFR-6         |
| **D1, D2, D3** | Хранилища Данных | **I**nformation Disclosure (Раскрытие) | Утечка данных из хранилищ D1/D2/D3 в случае компрометации сервера. | **Шифрование данных** на уровне файловой системы или базы данных; **Строгий сетевой сегмент** (Data Boundary).                                 | NFR-3         |
| **F15, F16** | P2/P3 → P4 (Async Message) | **R**epudiation (Отказ) | P2 или P3 могут не отправить событие аудита, что позволит пользователю отрицать выполнение критичной операции. | **Обязательная асинхронная отправка** события аудита (F15, F16); **Мониторинг** метрик (счетчиков) на P2/P3 для выявления пропущенных событий. | **NFR-6**     |
| **F8** | P1 → E1 (API Response) | **I**nformation Disclosure (Раскрытие) | Ответ об ошибке или неуспешной аутентификации раскрывает внутреннюю информацию (например, "Неверный пароль" vs "Пользователь не найден"). | **Унифицированный ответ** при ошибках аутентификации/авторизации (согласно политике безопасности).                                             | NFR-3         |
| **P4** | Audit Service | **E**levation of Privilege (Повышение) | Злоумышленник использует уязвимость в P4 для получения доступа к Audit Log Store (D3) или для выполнения кода на сервере. | P4 имеет доступ только к D3 (принцип наименьших привилегий); **Изоляция** P4 от других сервисов/сетей.                                         | NFR-3, NFR-6  |